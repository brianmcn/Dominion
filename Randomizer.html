<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Dominion!</title>
</head>
<body>
    <h1>Dominion randomizer</h1>
    <p>This page chooses 10 random cards from Dominion, Dark Ages, Guilds, Hinterlands, Intrigue, and Seaside.</p>
    <br/>
    <div id="cards"></div>
    <script type="text/javascript">
    function shuffle(array) {
      var currentIndex = array.length, temporaryValue, randomIndex ;

      // While there remain elements to shuffle...
      while (0 !== currentIndex) {

        // Pick a remaining element...
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex -= 1;

        // And swap it with the current element.
        temporaryValue = array[currentIndex];
        array[currentIndex] = array[randomIndex];
        array[randomIndex] = temporaryValue;
      }

      return array;
    }

    function main() {
        var all = {
            // Dark Ages
            "DA": [
                "Poor House",
                "Beggar",
                "Squire",
                "Vagrant",
                "Forager",
                ["Hermit","Madman"],
                "Market Square",
                "Sage",
                "Storeroom",
                "Urchin",
                "Armory",
                ["Death Cart", "Ruins"],
                "Feodum",
                "Fortress",
                "Ironmonger",
                ["Marauder", "Ruins", "Spoils"],
                "Procession",
                "Rats",
                "Scavenger",
                "Wandering Minstrel",
                "Band of Misfits",
                ["Bandit Camp", "Spoils"],
                "Catacombs",
                "Count",
                "Counterfeit",
                ["Cultist", "Ruins"],
                "Graverobber",
                "Junk Dealer",
                "Knights",
                "Mystic",
                ["Pillage", "Spoils"],
                "Rebuild",
                "Rogue",
                "Altar",
                "Hunting Grounds"],
            // Dominion
            "DO": [
                "Cellar",
                "Chapel",
                "Moat",
                "Chancellor",
                "Village",
                "Woodcutter",
                "Workshop",
                "Bureaucrat",
                "Feast",
                "Gardens",
                "Militia",
                "Moneylender",
                "Remodel",
                "Smithy",
                "Spy",
                "Thief",
                "Throne Room",
                "Council Room",
                "Festival",
                "Laboratory",
                "Library",
                "Market",
                "Mine",
                ["Witch", "Curse"],
                "Adventurer"],
            // Hinterlands
            "HI": [
                "Crossroads",
                "Duchess",
                "Fools Gold",
                "Develop",
                "Oasis",
                "Oracle",
                "Scheme",
                "Tunnel",
                "Jack of all Trades",
                "Noble Brigand",
                "Nomad Camp",
                "Silk Road",
                "Spice Merchant",
                "Trader",
                "Cache",
                "Cartographer",
                "Embassy",
                "Haggler",
                "Highway",
                ["Ill-Gotten Gains", "Curse"],
                "Inn",
                "Mandarin",
                "Margrave",
                "Stables",
                "Border Village",
                "Farmland"],
            // Intrigue
            "IN": [
                "Courtyard",
                "Pawn",
                "Secret Chamber",
                "Great Hall",
                "Masquerade",
                "Shanty Town",
                "Steward",
                "Swindler",
                "Wishing Well",
                "Baron",
                "Bridge",
                "Conspirator",
                "Coppersmith",
                "Ironworks",
                "Mining Village",
                "Scout",
                "Duke",
                "Minion",
                "Saboteur",
                ["Torturer", "Curse"],
                "Trading Post",
                "Tribute",
                "Upgrade",
                "Harem",
                "Nobles"],
            // Seaside
            "SE": [
                ["Embargo", "Curse"],
                "Haven",
                "Lighthouse",
                "Native Village",
                "Pearl Diver",
                "Ambassador",
                "Fishing Village",
                "Lookout",
                "Smugglers",
                "Warehouse",
                "Caravan",
                "Cutpurse",
                "Island",
                "Navigator",
                "Pirate Ship",
                "Salvager",
                ["Sea Hag", "Curse"],
                "Treasure Map",
                "Bazaar",
                "Explorer",
                "Ghost Ship",
                "Merchant Ship",
                "Outpost",
                "Tactician",
                "Treasury",
                "Wharf"],
            //Guilds
            "GU": [
                "Advisor",
                "Baker",
                "Butcher",
                "Candlestick Maker",
                "Doctor",
                "Herald",
                "Journeyman",
                "Masterpiece",
                "Merchant Guild",
                "Plaza",
                ["Soothsayer", "Curse"],
                "Stonemason",
                "Taxman"]
            }

        var flat_all = [];
        for(var set in all) {
            var cards = all[set];
            for(var i in cards) {
                var card = cards[i];
                var value = [set, card];
                flat_all.push(value);
            }
        }

        shuffle(flat_all);
        var chosen = [];
        var extra = {};
        for (i = 0; i < 10; i++) {
            var set = flat_all[i][0];
            var card = flat_all[i][1];
            if(typeof(card) == "object")
            {
                for(var j = 1; j < card.length; j++) {
                    extra[card[j]] = true;
                }
                card = card[0];
            }
            chosen[i] = set + " - " + card;
        }
        chosen[9] += "*";
        chosen.sort();

        for(var i in extra) {
            chosen.push("E - " + i);
        }

        document.getElementById("cards").innerHTML = chosen.join("<BR>");
    }

    main()
    </script>

</body>
</html>

